<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Page Title</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" media="screen" href="main.css" />
    <script src="main.js"></script>
</head>
<body>
    <div>
        <p id = "instructions">Try to guess my word <br></p>
        <p>Wins</p>
        <p id = "w"></p>
        <p id = "filled"></p>
        <p>Guesses Left</p>
        <p id ="gL"></p>
        <p>Letters Guessed</p>
        <p id = "lg"></p>
    </div>
    <script type="text/javascript">
        //Initializing variables to target html elements
        var numWins = document.getElementById("w");
        var partsFilled = document.getElementById("filled");
        var numGuessesLeft = document.getElementById("gL");
        var lettersGuessedDis = document.getElementById("lg");

        //Status tells wether or not the game is active 
        var status = true; 

        //Initializing player guess
        var playerGuess = ""

        //Array of Words to choose from
        var myWords = ["one", "two words", "three words here"];

        //Object that contains all valid inputs. When the user guesses a letter, it is removed from valid inputs until the next word is generated. 
        var validGuesses = {
            "a": true, "b": true, "c": true, "d": true, "e": true,"f": true,"g": true,"h": true,"i": true,"j": true,"k": true,"l": true,"m": true,"n": true,"o": true,
                "p": true,"q": true,"r": true,"s": true,"t": true,"u": true,"v": true,"w": true,"x": true,"y": true,"z": true, 
            alphabet: "abcdefghijklmnopqrstuvwxyz",
            //This function allows every letter a-z to be guessed again
            resetVG: function(){
                for (p = 0; p < 26; p++){
                    this[this.alphabet.charAt(p)] = true;
                }
            }
        }

        //Current Word Object
        var currentWord = {word: " ", displayWord: [],

            //Function that gets a word from my array of words and sets the current word to it
            getWord: function(){
                return myWords[Math.floor(Math.random() * myWords.length)];
            },
            /*Function that checks the player's input to see if it is in my word. If the player's input is in my word, it will update the display. After that it check's if the 
            word has been completely filled in. If the word has been completely filled in, then the player's score will be updated and a new word will be chosen. If the word 
            has not been completed, we wait for next input. If the player's guess was incorrect we subtract 1 from their guesses left and add their input to letters guessed. 
             */
            verifyGuess: function(pg){
                //Start by assuming the player did not have a correct guess
                var correctGuess = false;
                //Compare the player's guess with every letter in the current word
                for(i=0; i < this.word.length; i++){
                    //If the player's guess is in the word, this will show where it is in the display word, increase the number of correct guesses for the current word,
                    //and update the fact the player has guessed a letter correctly
                    if (pg == this.word.charAt(i)){
                        this.displayWord[i]= pg;
                        validGuesses[pg]= false;
                        correctGuess = true;
                    }
                }
                //If the player's guess was not found in the current word then they lose a guess and the letter is added to the list of incorrect guesses
                if (!correctGuess){
                    guessesLeft -=1;
                    lettersGuessed += pg;
                    validGuesses[pg] = false;
                }
                //If the user has found every lettter in the current word, the word complete function is  called
                if (this.displayWord.join("").trim() == this.word.trim()){
                            this.wordComplete();
                        }
            },

            //When this function is called, we reset the number of letters found in the word, reset the incorrect guesses, pick a new word from the array of my words,
            //call the function to reset the display word, and reset the number of guesses
            wordComplete: function(){
                // alert ("congrats you won!")
                lettersGuessed = "";
                this.word = this.getWord();
                this.setDisplayWord();
                wins++;
                guessesLeft = 10;
                validGuesses.resetVG();
            },

            //This function sets the display word to be a number of dashes in the spots of the letters of the word
            setDisplayWord: function(){
                this.displayWord = [];
                for(l =0;l < this.word.length; l++){
                    if(this.word.charAt(l) != " "){
                    this.displayWord[l]= "_";
                    }
                else{
                    this.displayWord[l]= " ";
                    }

                }
            return this.displayWord;
            }
        }

        //Initialize letters the player has already guessed
        var lettersGuessed = "";
        
        //Wins
        var wins = 0;

        //Number of Guesses Left
        var guessesLeft = 10;
        
        //This sets the first word 
        currentWord.word = currentWord.getWord();
        //This calls the function to set the display word to be a number of dashes equivalent to the number of letters in the word
        currentWord.displayWord = currentWord.setDisplayWord();
        //Sets placeholder so the player can see the structure of the word they need to guess
        var joinDW = ""
        for (q=0; q < currentWord.displayWord.length; q++){
                    joinDW += currentWord.displayWord[q];
                    //Adds a non breaking space to the display word because you can't add multiple spaces in a row to a string without a non-breaking char
                    joinDW += "\xa0"
                }
        partsFilled.textContent = joinDW;
        numWins.textContent = wins;

        //Function that Executes when the Player Presses a Key
        document.onkeyup = function(event){

            //We're Playing the Game and haven't lost
            if (status){
                
                playerGuess = event.key;
                //Attempts to check wether or not the players guess is valid. If the guess is valid, the game checks if the guess is in the word. 
                try{
                    if(validGuesses[playerGuess]){
                        currentWord.verifyGuess(playerGuess);
                    }
                    else{
                        // alert("you already guessed that letter")
                    }
                }
                catch(e){
                    alert("Please enter a letter a-z!")
                }
                joinDW = ""

                for (n=0; n < currentWord.displayWord.length; n++){
                    joinDW += currentWord.displayWord[n];
                    //Adds a non breaking space to the display word because you can't add multiple spaces in a row to a string without a non-breaking char
                    joinDW += "\xa0"
                }
                numWins.textContent = wins;
                partsFilled.textContent = joinDW;
                numGuessesLeft.textContent = guessesLeft;
                lettersGuessedDis.textContent = lettersGuessed;
            }
            //Reset the Game
            else{

            }
        }

    </script>
</body>
</html>